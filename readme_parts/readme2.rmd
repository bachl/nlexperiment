---
output: 
  html_document: 
    keep_md: yes
    self_contained: no
---

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "img/README-"
)
```


```{r, echo = FALSE}
library(nlexperiment)
# Set the path to your NetLogo instalation
nl_netlogo_path("c:/Program Files (x86)/NetLogo 5.2.0/") 
```


## Temporal measures
Set measures for each simulation step:
```{r StepModel}
experiment <- nl_experiment(
  model_file = file.path(nl_netlogo_path(), 
                         "models/Sample Models/Earth Science/Fire.nlogo"), 
  while_condition = "any? turtles",
  param_values = list(density = c(57, 59, 61)),
  random_seed = 1,
  step_measures = measures(
    percent_burned = "(burned-trees / initial-trees) * 100"
  )
)
```

Run the experiment:
```{r StepModelRun, cache=TRUE}
result <- nl_run(experiment)
```

To analyse the results from observations 
use `nl_get_step_result`:

```{r model_step_result, fig.height=4, cache=TRUE}
# get the observation data for step measures
dat <- nl_get_step_result(result)
head(dat)
```

Or use `nl_show_step` to plot 
observations based on temporal measures:

```{r model_step_plot, fig.height=4, cache=TRUE}
# get the observation data for step measures
nl_show_step(result, x_param = "density")
```



*Note: values `run_id` and `step_id` are included in the `result$step` by default.
Parameter values are included only by reference to `parameter_set_id`. The 
function `nl_get_result` joins parameter sets to observation data.*

