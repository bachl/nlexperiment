<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="nlexperiment : Define and run NetLogo experiments in R">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>nlexperiment</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/bergant/nlexperiment">View on GitHub</a>

          <h1 id="project_title">nlexperiment</h1>
          <h2 id="project_tagline">Define and run NetLogo experiments in R</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/bergant/nlexperiment/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/bergant/nlexperiment/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <p><a href="https://travis-ci.org/bergant/nlexperiment"><img src="https://travis-ci.org/bergant/nlexperiment.svg" alt=""></a></p>

<hr>

<p><a name="nlexperiment"></a>
<img src="img/logo.png" alt="nlexperiment"></p>

<h4>
<a id="define-and-run-netlogo-experiments-in-r" class="anchor" href="#define-and-run-netlogo-experiments-in-r" aria-hidden="true"><span class="octicon octicon-link"></span></a>Define and run NetLogo experiments in R</h4>

<p>The goal of <strong>nlexperiment</strong> is to make 
exploring NetLogo models with R as simple as possible 
while keeping advanced functionalities available to
advanced users.
It uses <a href="https://cran.r-project.org/web/packages/RNetLogo/">RNetLogo</a>
package (Thiele 2014) as an interface to NetLogo.</p>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h2>

<p><code>library(devtools)</code><br>
<code>install_github("bergant/nlexperiment")</code></p>

<h2>
<a id="simple-experiment-with-fire" class="anchor" href="#simple-experiment-with-fire" aria-hidden="true"><span class="octicon octicon-link"></span></a>Simple experiment with fire</h2>

<p>This sample experiment with NetLogo Fire model (Wilensky 1997) demonstrates
how to create and run minimal experiment. It runs the model with three parameter
values (forest density) and exports final NetLogo views to image files:</p>

<div class="highlight highlight-r"><pre>library(<span class="pl-smi">nlexperiment</span>)
<span class="pl-c"># Set the path to your NetLogo instalation</span>
nl_netlogo_path(<span class="pl-s"><span class="pl-pds">"</span>c:/Program Files (x86)/NetLogo 5.2.0/<span class="pl-pds">"</span></span>) 

<span class="pl-c"># Create NetLogo experiment object</span>
<span class="pl-smi">experiment</span> <span class="pl-k">&lt;-</span> nl_experiment(
  <span class="pl-v">model_file</span> <span class="pl-k">=</span> file.path(nl_netlogo_path(), 
                         <span class="pl-s"><span class="pl-pds">"</span>models/Sample Models/Earth Science/Fire.nlogo<span class="pl-pds">"</span></span>), 
  <span class="pl-v">while_condition</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>any? turtles<span class="pl-pds">"</span></span>,
  <span class="pl-v">param_values</span> <span class="pl-k">=</span> <span class="pl-k">list</span>(<span class="pl-v">density</span> <span class="pl-k">=</span> c(<span class="pl-c1">57</span>, <span class="pl-c1">59</span>, <span class="pl-c1">61</span>)),
  <span class="pl-v">random_seed</span> <span class="pl-k">=</span> <span class="pl-c1">1</span>,
  <span class="pl-v">export_view</span> <span class="pl-k">=</span> <span class="pl-c1">TRUE</span>
)</pre></div>

<p>Run the experiment:</p>

<div class="highlight highlight-r"><pre><span class="pl-smi">result</span> <span class="pl-k">&lt;-</span> nl_run(<span class="pl-smi">experiment</span>)  </pre></div>

<p>Find paths to the exported view image files in <code>result$export</code> or just display them by calling <code>nl_show_views_grid</code> function:</p>

<div class="highlight highlight-r"><pre>library(<span class="pl-smi">ggplot2</span>)
nl_show_views_grid(<span class="pl-smi">result</span>, <span class="pl-s"><span class="pl-pds">"</span>density<span class="pl-pds">"</span></span>)</pre></div>

<p><img src="img/README-model_view-1.png" alt=""> </p>

<h2>
<a id="observations-per-each-simulation-step" class="anchor" href="#observations-per-each-simulation-step" aria-hidden="true"><span class="octicon octicon-link"></span></a>Observations per each simulation step</h2>

<p>From statistical point of view, the interesting part of experiment is 
getting some quantitative information. 
This sample demonstrates how to set measures
for each simulation step.</p>

<div class="highlight highlight-r"><pre><span class="pl-smi">experiment</span> <span class="pl-k">&lt;-</span> nl_experiment(
  <span class="pl-v">model_file</span> <span class="pl-k">=</span> file.path(nl_netlogo_path(), 
                         <span class="pl-s"><span class="pl-pds">"</span>models/Sample Models/Earth Science/Fire.nlogo<span class="pl-pds">"</span></span>), 
  <span class="pl-v">while_condition</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>any? turtles<span class="pl-pds">"</span></span>,
  <span class="pl-v">param_values</span> <span class="pl-k">=</span> <span class="pl-k">list</span>(<span class="pl-v">density</span> <span class="pl-k">=</span> c(<span class="pl-c1">57</span>, <span class="pl-c1">59</span>, <span class="pl-c1">61</span>)),
  <span class="pl-v">random_seed</span> <span class="pl-k">=</span> <span class="pl-c1">1</span>,
  <span class="pl-v">step_measures</span> <span class="pl-k">=</span> measures(
    <span class="pl-v">percent_burned</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>(burned-trees / initial-trees) * 100<span class="pl-pds">"</span></span>
  )
)</pre></div>

<p>Run the experiment:</p>

<div class="highlight highlight-r"><pre><span class="pl-smi">result</span> <span class="pl-k">&lt;-</span> nl_run(<span class="pl-smi">experiment</span>)</pre></div>

<p>Plot of burned forest as a function of time for different forest densities:</p>

<div class="highlight highlight-r"><pre><span class="pl-c"># get the observation data for step measures</span>
<span class="pl-smi">dat</span> <span class="pl-k">&lt;-</span> nl_get_result(<span class="pl-smi">result</span>, <span class="pl-v">type</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>step<span class="pl-pds">"</span></span>) 
<span class="pl-c"># plot the observations</span>
library(<span class="pl-smi">ggplot2</span>)
ggplot(<span class="pl-smi">dat</span>, <span class="pl-v">mapping</span> <span class="pl-k">=</span> aes(<span class="pl-v">x</span> <span class="pl-k">=</span> <span class="pl-smi">step_id</span>, <span class="pl-v">y</span> <span class="pl-k">=</span> <span class="pl-smi">percent_burned</span>)) <span class="pl-k">+</span> 
  geom_step() <span class="pl-k">+</span>
  facet_grid(. <span class="pl-k">~</span> <span class="pl-smi">density</span>) <span class="pl-k">+</span>
  labs(<span class="pl-v">y</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Percent burned<span class="pl-pds">"</span></span>, <span class="pl-v">x</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Iteration<span class="pl-pds">"</span></span>)</pre></div>

<p><img src="img/README-model_step_plot-1.png" alt=""> </p>

<p><em>Note: values <code>run_id</code> and <code>step_id</code> are included in the <code>results$step</code> by default.
Parameter values are included only by reference to <code>parameter_set_id</code>. The 
function <code>nl_get_result</code> joins parameter sets to observation data.</em></p>

<h2>
<a id="observations-per-each-simulation-run" class="anchor" href="#observations-per-each-simulation-run" aria-hidden="true"><span class="octicon octicon-link"></span></a>Observations per each simulation run</h2>

<p>In this example</p>

<ul>
<li>two measures <em>per simulation run</em> are defined (values are reported at the end 
of each simulation run),</li>
<li>the model will be run repetedly <code>30</code> times for every parameter value</li>
<li>and the model is running with <code>parallel</code> option (to save some time)</li>
</ul>

<div class="highlight highlight-r"><pre><span class="pl-smi">experiment</span> <span class="pl-k">&lt;-</span> nl_experiment(
  <span class="pl-v">model_file</span> <span class="pl-k">=</span> file.path(nl_netlogo_path(), 
                         <span class="pl-s"><span class="pl-pds">"</span>models/Sample Models/Earth Science/Fire.nlogo<span class="pl-pds">"</span></span>), 
  <span class="pl-v">while_condition</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>any? turtles<span class="pl-pds">"</span></span>,
  <span class="pl-v">repetitions</span> <span class="pl-k">=</span> <span class="pl-c1">30</span>,
  <span class="pl-v">run_measures</span> <span class="pl-k">=</span> measures(
    <span class="pl-v">percent_burned</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>(burned-trees / initial-trees) * 100<span class="pl-pds">"</span></span>,
    <span class="pl-v">progress</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>max [pxcor] of patches with [pcolor &gt; 0 and pcolor &lt; 55]<span class="pl-pds">"</span></span>
  ),
  <span class="pl-v">param_values</span> <span class="pl-k">=</span> <span class="pl-k">list</span>(
    <span class="pl-v">density</span> <span class="pl-k">=</span> seq(<span class="pl-v">from</span> <span class="pl-k">=</span> <span class="pl-c1">55</span>, <span class="pl-v">to</span> <span class="pl-k">=</span> <span class="pl-c1">62</span>, <span class="pl-v">by</span> <span class="pl-k">=</span> <span class="pl-c1">1</span>)
  )
)</pre></div>

<p>Run the experiment with <code>parallel</code> option:</p>

<div class="highlight highlight-r"><pre><span class="pl-smi">result</span> <span class="pl-k">&lt;-</span> nl_run(<span class="pl-smi">experiment</span>, <span class="pl-v">parallel</span> <span class="pl-k">=</span> <span class="pl-c1">TRUE</span>)
<span class="pl-c"># Join observations with parameter set values:</span>
<span class="pl-smi">dat</span> <span class="pl-k">&lt;-</span> nl_get_run_result(<span class="pl-smi">result</span>, <span class="pl-v">add_parameters</span> <span class="pl-k">=</span> <span class="pl-c1">TRUE</span>)</pre></div>

<p>Plot the results - percent burned as a function of density:</p>

<div class="highlight highlight-r"><pre><span class="pl-c"># plot percent burned by density</span>
library(<span class="pl-smi">ggplot2</span>)
ggplot(<span class="pl-smi">dat</span>, <span class="pl-v">mapping</span> <span class="pl-k">=</span> aes(<span class="pl-v">x</span> <span class="pl-k">=</span> <span class="pl-k">factor</span>(<span class="pl-smi">density</span>), <span class="pl-v">y</span> <span class="pl-k">=</span> <span class="pl-smi">percent_burned</span>) ) <span class="pl-k">+</span> 
  geom_violin() <span class="pl-k">+</span>
  <span class="pl-c">#geom_jitter(position = position_jitter(width = .1), alpha = 0.3) +</span>
  labs(<span class="pl-v">x</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Forest density<span class="pl-pds">"</span></span>, <span class="pl-v">y</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Percent burned<span class="pl-pds">"</span></span>)</pre></div>

<p><img src="img/README-p3plot1-1.png" alt=""> </p>

<p>Fire advances from left to right. It is interesting to observe
final fire position (left border = 0 and right = 1) as a function of density.</p>

<div class="highlight highlight-r"><pre>ggplot(<span class="pl-smi">dat</span>, <span class="pl-v">mapping</span> <span class="pl-k">=</span> aes(<span class="pl-v">x</span> <span class="pl-k">=</span> <span class="pl-k">factor</span>(<span class="pl-smi">density</span>), <span class="pl-v">y</span> <span class="pl-k">=</span> <span class="pl-smi">progress</span><span class="pl-k">/</span><span class="pl-c1">250</span> <span class="pl-k">+</span> <span class="pl-c1">0.5</span>) ) <span class="pl-k">+</span> 
  geom_jitter(<span class="pl-v">position</span> <span class="pl-k">=</span> position_jitter(<span class="pl-v">width</span> <span class="pl-k">=</span> .<span class="pl-c1">1</span>), <span class="pl-v">alpha</span> <span class="pl-k">=</span> <span class="pl-c1">0.3</span>)  <span class="pl-k">+</span>
  theme_minimal() <span class="pl-k">+</span>
  labs(<span class="pl-v">x</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Forest density<span class="pl-pds">"</span></span>, <span class="pl-v">y</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Fire progress<span class="pl-pds">"</span></span>)</pre></div>

<p><img src="img/README-p3plot2-1.png" alt=""> </p>

<h2>
<a id="reading-agent-variables" class="anchor" href="#reading-agent-variables" aria-hidden="true"><span class="octicon octicon-link"></span></a>Reading agent variables</h2>

<p>While <code>run_measures</code> (see <a href="#observations-per-each-simulation-run">Observation per run</a>) is good enough for aggregate measures, sometimes we need values for each agent individually.
Example shows usage of <code>agents_after</code> parameter to get vertices from Preferential attachment
model.</p>

<div class="highlight highlight-r"><pre><span class="pl-smi">experiment</span> <span class="pl-k">&lt;-</span> nl_experiment(
  <span class="pl-v">model_file</span> <span class="pl-k">=</span> file.path(nl_netlogo_path(), 
                         <span class="pl-s"><span class="pl-pds">"</span>models/Sample models/Networks/Preferential attachment.nlogo<span class="pl-pds">"</span></span>), 
  <span class="pl-v">iterations</span> <span class="pl-k">=</span> <span class="pl-c1">50</span>,
  <span class="pl-v">agents_after</span> <span class="pl-k">=</span> <span class="pl-k">list</span>(
    <span class="pl-v">vertices</span> <span class="pl-k">=</span> agent_set(
      <span class="pl-v">vars</span> <span class="pl-k">=</span> c(<span class="pl-s"><span class="pl-pds">"</span>who<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>xcor<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>ycor<span class="pl-pds">"</span></span>), 
      <span class="pl-v">agents</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>turtles<span class="pl-pds">"</span></span>),
    <span class="pl-v">edges</span> <span class="pl-k">=</span> agent_set(
      <span class="pl-v">vars</span> <span class="pl-k">=</span> c(<span class="pl-v">e1</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>[who] of end1<span class="pl-pds">"</span></span>, <span class="pl-v">e2</span> <span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>[who] of end2<span class="pl-pds">"</span></span>), 
      <span class="pl-v">agents</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>links<span class="pl-pds">"</span></span>)
  ),
  <span class="pl-v">repetitions</span> <span class="pl-k">=</span> <span class="pl-c1">2</span>,
  <span class="pl-v">random_seed</span> <span class="pl-k">=</span> c(<span class="pl-c1">42</span>, <span class="pl-c1">69</span>)
)</pre></div>

<p><em>Note:</em></p>

<ul>
<li><em>Here random seed is defined as a vector. It is applied to each repetition respectively.</em></li>
<li><em>Variables in agent set may or may not include variable names.</em></li>
<li><em>Element <code>agents_before</code> is analogous tp <code>agents_after</code> - it just gets the data before model runs.)</em></li>
</ul>

<p>Run experiment</p>

<div class="highlight highlight-r"><pre><span class="pl-smi">result</span> <span class="pl-k">&lt;-</span> nl_run(<span class="pl-smi">experiment</span>)
<span class="pl-c">#&gt; Warning: Parameter sets not defined. Using default parameters</span></pre></div>

<p>Show graph by using <strong>igraph</strong> package:</p>

<div class="highlight highlight-r"><pre>library(<span class="pl-smi">igraph</span>, <span class="pl-v">quietly</span> <span class="pl-k">=</span> <span class="pl-c1">TRUE</span>, <span class="pl-v">warn.conflicts</span> <span class="pl-k">=</span> <span class="pl-c1">FALSE</span>)
par(<span class="pl-v">mfrow</span><span class="pl-k">=</span>c(<span class="pl-c1">1</span>,<span class="pl-c1">2</span>), <span class="pl-v">mai</span><span class="pl-k">=</span>c(<span class="pl-c1">0</span>,<span class="pl-c1">0</span>,<span class="pl-c1">0</span>,<span class="pl-c1">0</span>))
<span class="pl-k">for</span>(<span class="pl-smi">i</span> <span class="pl-k">in</span> <span class="pl-c1">1</span><span class="pl-k">:</span><span class="pl-smi">experiment</span><span class="pl-k">$</span><span class="pl-smi">run_options</span><span class="pl-k">$</span><span class="pl-smi">repetitions</span>) {
  <span class="pl-smi">g_edges</span> <span class="pl-k">&lt;-</span> subset(<span class="pl-smi">result</span><span class="pl-k">$</span><span class="pl-smi">agents_after</span><span class="pl-k">$</span><span class="pl-smi">edges</span>, <span class="pl-smi">run_id</span> <span class="pl-k">==</span> <span class="pl-smi">i</span>)
  <span class="pl-smi">g1</span> <span class="pl-k">&lt;-</span> graph.data.frame(<span class="pl-smi">g_edges</span>, <span class="pl-v">directed</span> <span class="pl-k">=</span> <span class="pl-c1">FALSE</span>)
  V(<span class="pl-smi">g1</span>)<span class="pl-k">$</span><span class="pl-smi">size</span> <span class="pl-k">&lt;-</span> sqrt(degree(<span class="pl-smi">g1</span>))<span class="pl-k">*</span><span class="pl-c1">6</span>
  V(<span class="pl-smi">g1</span>)<span class="pl-k">$</span><span class="pl-smi">label</span> <span class="pl-k">&lt;-</span> ifelse(as.numeric(V(<span class="pl-smi">g1</span>)<span class="pl-k">$</span><span class="pl-smi">name</span>) <span class="pl-k">&lt;</span> <span class="pl-c1">4</span>, as.numeric(V(<span class="pl-smi">g1</span>)<span class="pl-k">$</span><span class="pl-smi">name</span>), <span class="pl-c1">NA</span>)
  plot.igraph(<span class="pl-smi">g1</span>, <span class="pl-v">margin</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>, 
              <span class="pl-v">vertex.label.font</span> <span class="pl-k">=</span> V(<span class="pl-smi">g1</span>)<span class="pl-k">$</span><span class="pl-smi">size</span> <span class="pl-k">*</span> <span class="pl-c1">0.07</span>,
              <span class="pl-v">vertex.label.color</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>white<span class="pl-pds">"</span></span>,
              <span class="pl-v">vertex.color</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>darkseagreen4<span class="pl-pds">"</span></span>,
              <span class="pl-v">edge.color</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>gray<span class="pl-pds">"</span></span>,
              <span class="pl-v">vertex.frame.color</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>#ffffff<span class="pl-pds">"</span></span>,
              <span class="pl-v">edge.curved</span><span class="pl-k">=</span>.<span class="pl-c1">1</span>
  )
}</pre></div>

<p><img src="img/README-p6Sigraph-1.png" alt=""> </p>

<p><em>Note:</em></p>

<ul>
<li><em>Data frame <code>result$agents_after$edges</code> includes variables from all simulation runs.</em></li>
<li><em>Use <code>param_space_id</code> and/or <code>run_id</code> columns to subset individual run or parameter combination</em></li>
</ul>

<h2>
<a id="reading-patches" class="anchor" href="#reading-patches" aria-hidden="true"><span class="octicon octicon-link"></span></a>Reading patches</h2>

<p>Getting patches information is analogous to reading agents' data from NetLogo model:</p>

<div class="highlight highlight-r"><pre><span class="pl-smi">experiment2</span> <span class="pl-k">&lt;-</span> nl_experiment( 
  <span class="pl-v">model_file</span> <span class="pl-k">=</span> file.path(nl_netlogo_path(), 
                         <span class="pl-s"><span class="pl-pds">"</span>models/Sample Models/Biology/Fur.nlogo<span class="pl-pds">"</span></span>), 
  <span class="pl-v">iterations</span> <span class="pl-k">=</span> <span class="pl-c1">20</span>,                                     

  <span class="pl-v">param_values</span> <span class="pl-k">=</span> <span class="pl-k">list</span>(
    <span class="pl-v">ratio</span> <span class="pl-k">=</span> c(<span class="pl-c1">0.3</span>, <span class="pl-c1">0.35</span>, <span class="pl-c1">0.4</span>, <span class="pl-c1">0.45</span>)
  ),
  <span class="pl-v">patches_after</span> <span class="pl-k">=</span> <span class="pl-k">list</span>(
    <span class="pl-v">patches</span> <span class="pl-k">=</span> patch_set(
      <span class="pl-v">vars</span> <span class="pl-k">=</span> c(<span class="pl-s"><span class="pl-pds">"</span>pxcor<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>pycor<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>pcolor<span class="pl-pds">"</span></span>),
      <span class="pl-v">patches</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>patches<span class="pl-pds">"</span></span>
    )
  ),
  <span class="pl-v">random_seed</span> <span class="pl-k">=</span> <span class="pl-c1">2</span>
)

<span class="pl-smi">result2</span> <span class="pl-k">&lt;-</span> nl_run(<span class="pl-smi">experiment2</span>)

nl_show_patches(<span class="pl-smi">result2</span>, <span class="pl-v">x_param</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>ratio<span class="pl-pds">"</span></span>) <span class="pl-k">+</span>
  <span class="pl-e">ggplot2</span><span class="pl-k">::</span>scale_fill_manual(<span class="pl-v">values</span> <span class="pl-k">=</span> c(<span class="pl-s"><span class="pl-pds">"</span>black<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>white<span class="pl-pds">"</span></span>))</pre></div>

<p><img src="img/README-p6E2-1.png" alt=""> </p>

<h2>
<a id="simple-parameter-sets-definition" class="anchor" href="#simple-parameter-sets-definition" aria-hidden="true"><span class="octicon octicon-link"></span></a>Simple parameter sets definition</h2>

<p>The following example is using Ant model (Wilensky 1997) to show 
simple parameter sets definition and parameter mapping.</p>

<div class="highlight highlight-r"><pre><span class="pl-smi">experiment</span> <span class="pl-k">&lt;-</span> nl_experiment(
  <span class="pl-v">model_file</span> <span class="pl-k">=</span> file.path(nl_netlogo_path(), 
                         <span class="pl-s"><span class="pl-pds">"</span>models/Sample Models/Biology/Ants.nlogo<span class="pl-pds">"</span></span>), 
  <span class="pl-v">iterations</span> <span class="pl-k">=</span> <span class="pl-c1">150</span>,
  <span class="pl-v">step_measures</span> <span class="pl-k">=</span> measures(
    <span class="pl-v">pile1</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>sum [food] of patches with [pcolor = cyan]<span class="pl-pds">"</span></span>,  
    <span class="pl-v">pile2</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>sum [food] of patches with [pcolor = sky]<span class="pl-pds">"</span></span>,  
    <span class="pl-v">pile3</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>sum [food] of patches with [pcolor = blue]<span class="pl-pds">"</span></span>  
  ),
  <span class="pl-v">param_values</span> <span class="pl-k">=</span> <span class="pl-k">list</span>(
    <span class="pl-v">population</span> <span class="pl-k">=</span> <span class="pl-c1">125</span>,
    <span class="pl-v">diffusion_rate</span> <span class="pl-k">=</span> c(<span class="pl-c1">50</span>, <span class="pl-c1">70</span>),
    <span class="pl-v">evaporation_rate</span> <span class="pl-k">=</span> c(<span class="pl-c1">5</span>, <span class="pl-c1">10</span>, <span class="pl-c1">15</span>)
  ),
  <span class="pl-v">mapping</span> <span class="pl-k">=</span> c(
    <span class="pl-v">diffusion_rate</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>diffusion-rate<span class="pl-pds">"</span></span>,
    <span class="pl-v">evaporation_rate</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>evaporation-rate<span class="pl-pds">"</span></span>
    ),
  <span class="pl-v">random_seed</span> <span class="pl-k">=</span> <span class="pl-c1">2</span>,
  <span class="pl-v">export_view</span> <span class="pl-k">=</span> <span class="pl-c1">TRUE</span>
)</pre></div>

<p><em>Note:</em></p>

<ul>
<li><em>When parameters are defined as a list of value vecors, parameter sets are
constructed as combination of all possible parameter value combination</em></li>
<li><em>It is not required to include all parameters in mapping. Variable <code>population</code> 
is used as is.</em></li>
<li><em>NetLogo identifiers may include some ASCII characters <code>(?=*!&lt;&gt;:#+/%$^'&amp;-)</code>
that makes the R part of data manipulation rather uncomfortable.</em></li>
<li><em>Element <code>mapping</code> maps <code>difussion_rate</code> and <code>evaporation_rate</code> names to NetLogo variables <code>diffusion-rate</code> and <code>evaporation-rate</code>.</em></li>
</ul>

<p>Run experiment</p>

<div class="highlight highlight-r"><pre><span class="pl-smi">results</span> <span class="pl-k">&lt;-</span> nl_run(<span class="pl-smi">experiment</span>)  </pre></div>

<p>Show views</p>

<div class="highlight highlight-r"><pre>nl_show_views_grid(<span class="pl-smi">results</span>, <span class="pl-s"><span class="pl-pds">"</span>evaporation_rate<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>diffusion_rate<span class="pl-pds">"</span></span>)</pre></div>

<p><img src="img/README-p5ShowViews-1.png" alt=""> </p>

<p>Show remaining food by difussion rate and evaporation rate for all food piles</p>

<div class="highlight highlight-r"><pre>library(<span class="pl-smi">tidyr</span>)
<span class="pl-smi">dat</span> <span class="pl-k">&lt;-</span> nl_get_step_result(<span class="pl-smi">results</span>)
<span class="pl-smi">dat</span> <span class="pl-k">&lt;-</span> <span class="pl-e">tidyr</span><span class="pl-k">::</span>gather(<span class="pl-smi">dat</span>, <span class="pl-smi">pile</span>, <span class="pl-smi">value</span>, <span class="pl-smi">pile1</span>, <span class="pl-smi">pile2</span>, <span class="pl-smi">pile3</span>)

library(<span class="pl-smi">ggplot2</span>)
ggplot(<span class="pl-smi">dat</span>, aes(<span class="pl-v">x</span> <span class="pl-k">=</span> <span class="pl-smi">step_id</span>, <span class="pl-v">y</span> <span class="pl-k">=</span> <span class="pl-smi">value</span>, <span class="pl-v">color</span> <span class="pl-k">=</span> <span class="pl-smi">pile</span>) ) <span class="pl-k">+</span>
  geom_line() <span class="pl-k">+</span>
  facet_grid(<span class="pl-smi">diffusion_rate</span> <span class="pl-k">~</span> <span class="pl-smi">evaporation_rate</span>)</pre></div>

<p><img src="img/README-p5plot-1.png" alt=""> </p>

<h2>
<a id="parameter-space-mapping" class="anchor" href="#parameter-space-mapping" aria-hidden="true"><span class="octicon octicon-link"></span></a>Parameter space mapping</h2>

<p>The following example is using NetLogo Fur model (Wilensky 2003) to show 
explicit definition of parameter sets and parameter mapping.</p>

<p>There are 5 parameters in the NetLogo Fur model: </p>

<ul>
<li>
<code>ratio</code> </li>
<li><code>outer-radius-y</code></li>
<li><code>inner-radius-y</code></li>
<li><code>outer-radius-x</code></li>
<li><code>inner-radius-x</code></li>
</ul>

<p>But considering constraints and model symmetry
we can reduce the parameters to:</p>

<ul>
<li>
<code>ratio</code> (the inhibitor concentration parameter)</li>
<li>
<code>radius_diff</code> (the difference between x and y radius) and</li>
<li>
<code>gap</code> (distance between inner and outer ellipse)</li>
</ul>

<p>(for simplicity let's keep the <code>gap</code> between the circles constant):</p>

<div class="highlight highlight-r"><pre><span class="pl-smi">experiment</span> <span class="pl-k">&lt;-</span> nl_experiment( 
  <span class="pl-v">model_file</span> <span class="pl-k">=</span> file.path(nl_netlogo_path(), 
                         <span class="pl-s"><span class="pl-pds">"</span>models/Sample Models/Biology/Fur.nlogo<span class="pl-pds">"</span></span>), 
  <span class="pl-v">iterations</span> <span class="pl-k">=</span> <span class="pl-c1">20</span>,                                     

  <span class="pl-v">param_values</span> <span class="pl-k">=</span> {                                  <span class="pl-c"># Parameter sets:</span>
    <span class="pl-smi">param_sets</span> <span class="pl-k">&lt;-</span> expand.grid(                      <span class="pl-c">#   all combinations of</span>
        <span class="pl-v">gap</span> <span class="pl-k">=</span> <span class="pl-c1">3</span>,                                    <span class="pl-c">#   gap, ratio and ry- rx</span>
        <span class="pl-v">radius_diff</span> <span class="pl-k">=</span> seq(<span class="pl-c1">0</span>, <span class="pl-c1">2</span>, <span class="pl-v">by</span> <span class="pl-k">=</span> <span class="pl-c1">0.5</span>), 
        <span class="pl-v">ratio</span> <span class="pl-k">=</span> seq(<span class="pl-c1">0.30</span>, <span class="pl-c1">0.65</span>, <span class="pl-v">by</span> <span class="pl-k">=</span> <span class="pl-c1">0.05</span>)
    )
    transform(<span class="pl-smi">param_sets</span>,                           <span class="pl-c"># Transform to NetLogo</span>
      <span class="pl-v">inner_radius_x</span> <span class="pl-k">=</span> <span class="pl-c1">3</span>,                           <span class="pl-c">#   variables</span>
      <span class="pl-v">outer_radius_x</span> <span class="pl-k">=</span> <span class="pl-c1">3</span> <span class="pl-k">+</span> <span class="pl-smi">gap</span>,
      <span class="pl-v">inner_radius_y</span> <span class="pl-k">=</span> <span class="pl-c1">3</span> <span class="pl-k">+</span> <span class="pl-smi">radius_diff</span>,
      <span class="pl-v">outer_radius_y</span> <span class="pl-k">=</span> <span class="pl-c1">3</span> <span class="pl-k">+</span> <span class="pl-smi">radius_diff</span> <span class="pl-k">+</span> <span class="pl-smi">gap</span>
    )
  },
  <span class="pl-v">mapping</span> <span class="pl-k">=</span> c(
    <span class="pl-v">gap</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>,
    <span class="pl-v">radius_diff</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>,
    <span class="pl-v">inner_radius_x</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>inner-radius-x<span class="pl-pds">"</span></span>,
    <span class="pl-v">outer_radius_x</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>outer-radius-x<span class="pl-pds">"</span></span>,
    <span class="pl-v">inner_radius_y</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>inner-radius-y<span class="pl-pds">"</span></span>,
    <span class="pl-v">outer_radius_y</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>outer-radius-y<span class="pl-pds">"</span></span>
  ),
  <span class="pl-v">patches_after</span> <span class="pl-k">=</span> <span class="pl-k">list</span>(
    <span class="pl-v">patches</span> <span class="pl-k">=</span> patch_set(
      <span class="pl-v">vars</span> <span class="pl-k">=</span> c(<span class="pl-s"><span class="pl-pds">"</span>pxcor<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>pycor<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>pcolor<span class="pl-pds">"</span></span>),
      <span class="pl-v">patches</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>patches<span class="pl-pds">"</span></span>
    )
  ),  
  <span class="pl-v">random_seed</span> <span class="pl-k">=</span> <span class="pl-c1">3</span>
)</pre></div>

<p><em>Note:</em> </p>

<ul>
<li>
<em>Element <code>param_values</code> is set by a data frame with explicit parameter sets</em> </li>
<li><em>Variables <code>gap</code> and <code>radius_diff</code> must be mapped to empty string (not NetLogo variables).</em></li>
</ul>

<p>Run experiment</p>

<div class="highlight highlight-r"><pre><span class="pl-smi">result</span> <span class="pl-k">&lt;-</span> nl_run(<span class="pl-smi">experiment</span>, <span class="pl-v">parallel</span> <span class="pl-k">=</span> <span class="pl-c1">TRUE</span>, <span class="pl-v">max_cores</span> <span class="pl-k">=</span> <span class="pl-c1">3</span>)    </pre></div>

<p>Show resulting fur patterns:</p>

<div class="highlight highlight-r"><pre>library(<span class="pl-smi">ggplot2</span>)
nl_show_patches(<span class="pl-smi">result</span>, <span class="pl-v">x_param</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>ratio<span class="pl-pds">"</span></span>, <span class="pl-v">y_param</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>radius_diff<span class="pl-pds">"</span></span>) <span class="pl-k">+</span> 
  scale_fill_manual(<span class="pl-v">values</span> <span class="pl-k">=</span> c(<span class="pl-s"><span class="pl-pds">"</span>black<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>white<span class="pl-pds">"</span></span>)) <span class="pl-k">+</span>
  labs(<span class="pl-v">y</span><span class="pl-k">=</span>expression(<span class="pl-smi">radius</span>[<span class="pl-smi">y</span>] <span class="pl-k">-</span> <span class="pl-smi">radius</span>[<span class="pl-smi">x</span>]), <span class="pl-v">title</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Fur patterns (gap = 3)<span class="pl-pds">"</span></span>)</pre></div>

<p><img src="img/README-p7ShowViews-1.png" alt=""> </p>

<h2>
<a id="categorical-criteria-function" class="anchor" href="#categorical-criteria-function" aria-hidden="true"><span class="octicon octicon-link"></span></a>Categorical criteria function</h2>

<p>This example uses NetLogo Hoopoes model from Railsback &amp; Grimm (2011).
Here the approach is the same as in the Thiele, Kurth &amp; Grimm (2014)
except using the <strong>nlexperiment</strong> framework instead of original R scripts.
See Factorial design and Latin hypercube sampling chapters in the 
<a href="http://jasss.soc.surrey.ac.uk/17/3/11.html">article</a>. </p>

<p>Define an experiment with evaluation criteria<br>
<em>abundance</em>, <em>variation</em> and <em>vacancy</em> (see <code>eval_criteria</code> element)
and categorical boolean criteria based on satisfactory ranges (see <code>eval_mutate</code>):</p>

<div class="highlight highlight-r"><pre><span class="pl-smi">experiment</span> <span class="pl-k">&lt;-</span> nl_experiment( 
  <span class="pl-v">model_file</span> <span class="pl-k">=</span> 
    system.file(<span class="pl-s"><span class="pl-pds">"</span>netlogo_models/SM2_Hoopoes.nlogo<span class="pl-pds">"</span></span>, <span class="pl-v">package</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>nlexperiment<span class="pl-pds">"</span></span>),

  <span class="pl-v">setup_commands</span> <span class="pl-k">=</span> c(<span class="pl-s"><span class="pl-pds">"</span>setup<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>repeat 24 [go]<span class="pl-pds">"</span></span>), <span class="pl-c"># 2 years of warming-up</span>
  <span class="pl-v">go_command</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>repeat 12 [go]<span class="pl-pds">"</span></span>,                 <span class="pl-c"># iteration is per year</span>
  <span class="pl-v">iterations</span> <span class="pl-k">=</span> <span class="pl-c1">20</span>,                               <span class="pl-c"># run for 20 years</span>
  <span class="pl-v">repetitions</span> <span class="pl-k">=</span> <span class="pl-c1">10</span>,                              <span class="pl-c"># repeat simulation 10 times</span>

  <span class="pl-v">param_values</span> <span class="pl-k">=</span> <span class="pl-k">list</span>(                           <span class="pl-c"># "full factor design"</span>
    <span class="pl-v">scout_prob</span> <span class="pl-k">=</span> seq(<span class="pl-v">from</span> <span class="pl-k">=</span> <span class="pl-c1">0.00</span>, <span class="pl-v">to</span> <span class="pl-k">=</span> <span class="pl-c1">0.50</span>, <span class="pl-v">by</span> <span class="pl-k">=</span> <span class="pl-c1">0.05</span>),
    <span class="pl-v">survival_prob</span> <span class="pl-k">=</span> seq(<span class="pl-v">from</span> <span class="pl-k">=</span> <span class="pl-c1">0.950</span>, <span class="pl-v">to</span> <span class="pl-k">=</span> <span class="pl-c1">1.000</span>, <span class="pl-v">by</span> <span class="pl-k">=</span> <span class="pl-c1">0.005</span>)
  ),
  <span class="pl-v">mapping</span> <span class="pl-k">=</span> c(                                   <span class="pl-c"># map NetLogo variables</span>
    <span class="pl-v">scout_prob</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>scout-prob<span class="pl-pds">"</span></span>, 
    <span class="pl-v">survival_prob</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>survival-prob<span class="pl-pds">"</span></span>
  ),

  <span class="pl-v">step_measures</span> <span class="pl-k">=</span> measures(                      <span class="pl-c"># NetLogo reporters per step</span>
    <span class="pl-v">abund</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>month-11-count<span class="pl-pds">"</span></span>,             
    <span class="pl-v">alpha</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>month-11-alpha<span class="pl-pds">"</span></span>,                 
    <span class="pl-v">patches_count</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>count patches<span class="pl-pds">"</span></span>
  ),

  <span class="pl-v">eval_criteria</span> <span class="pl-k">=</span> criteria(                      <span class="pl-c"># evaluation per each run</span>
    <span class="pl-v">abundance</span> <span class="pl-k">=</span> mean(<span class="pl-smi">step</span><span class="pl-k">$</span><span class="pl-smi">abund</span>),
    <span class="pl-v">variation</span> <span class="pl-k">=</span> sd(<span class="pl-smi">step</span><span class="pl-k">$</span><span class="pl-smi">abund</span>),
    <span class="pl-v">vacancy</span> <span class="pl-k">=</span> mean(<span class="pl-smi">step</span><span class="pl-k">$</span><span class="pl-smi">alpha</span> <span class="pl-k">/</span> <span class="pl-smi">step</span><span class="pl-k">$</span><span class="pl-smi">patches_count</span>)
  ),

  <span class="pl-v">eval_aggregate_fun</span> <span class="pl-k">=</span> <span class="pl-smi">mean</span>,                     <span class="pl-c"># mean value (10 repetitions)</span>

  <span class="pl-v">eval_mutate</span> <span class="pl-k">=</span> criteria(                        <span class="pl-c"># categorical criteria</span>
    <span class="pl-v">c_abundance</span> <span class="pl-k">=</span> <span class="pl-smi">abundance</span> <span class="pl-k">&gt;</span> <span class="pl-c1">115</span> <span class="pl-k">&amp;</span> <span class="pl-smi">abundance</span> <span class="pl-k">&lt;</span> <span class="pl-c1">135</span>,
    <span class="pl-v">c_variation</span> <span class="pl-k">=</span> <span class="pl-smi">variation</span> <span class="pl-k">&gt;</span> <span class="pl-c1">10</span> <span class="pl-k">&amp;</span> <span class="pl-smi">variation</span> <span class="pl-k">&lt;</span> <span class="pl-c1">15</span>,
    <span class="pl-v">c_vacancy</span> <span class="pl-k">=</span> <span class="pl-smi">vacancy</span> <span class="pl-k">&gt;</span> <span class="pl-c1">0.15</span> <span class="pl-k">&amp;</span> <span class="pl-smi">vacancy</span> <span class="pl-k">&lt;</span> <span class="pl-c1">0.30</span>
  )  
)</pre></div>

<p><em>Note:</em> </p>

<ul>
<li><em>The iteration is set to 12 times calling <code>go</code> procedure (1 iteration step = 12 NetLogo ticks)</em></li>
<li><em>When using list of parameter values, full parameter set is evaluated</em></li>
<li>
<em>Criteria function receives all the results from model run and returns numerical vector</em> </li>
<li><em>Results from criteria function are aggregated by parameter sets over 10 repetitions</em></li>
<li><em>Additionally categorical criteria is defined with ranges</em></li>
</ul>

<p>Run experiment:</p>

<div class="highlight highlight-r"><pre><span class="pl-smi">result</span> <span class="pl-k">&lt;-</span> nl_run(<span class="pl-smi">experiment</span>, <span class="pl-v">parallel</span> <span class="pl-k">=</span> <span class="pl-c1">TRUE</span>) 
<span class="pl-c"># get the data (criteria)</span>
<span class="pl-smi">dat</span> <span class="pl-k">&lt;-</span> nl_get_result(<span class="pl-smi">result</span>, <span class="pl-v">type</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>criteria<span class="pl-pds">"</span></span>) </pre></div>

<p>Returned data frame includes parameter sets with evaluation criteria:</p>

<div class="highlight highlight-r"><pre>str(<span class="pl-smi">dat</span>)
<span class="pl-c">#&gt; 'data.frame':    121 obs. of  9 variables:</span>
<span class="pl-c">#&gt;  $ scout_prob   : num  0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4 0.45 ...</span>
<span class="pl-c">#&gt;  $ survival_prob: num  0.95 0.95 0.95 0.95 0.95 0.95 0.95 0.95 0.95 0.95 ...</span>
<span class="pl-c">#&gt;  $ param_set_id : int  1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="pl-c">#&gt;  $ abundance    : num  4.67 4.46 5.08 6.18 5.35 ...</span>
<span class="pl-c">#&gt;  $ variation    : num  9.15 8.15 9.67 11.12 9.58 ...</span>
<span class="pl-c">#&gt;  $ vacancy      : num  0.981 0.98 0.98 0.966 0.976 ...</span>
<span class="pl-c">#&gt;  $ c_abundance  : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...</span>
<span class="pl-c">#&gt;  $ c_variation  : logi  FALSE FALSE FALSE TRUE FALSE FALSE ...</span>
<span class="pl-c">#&gt;  $ c_vacancy    : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...</span></pre></div>

<p>Plot categorical criteria on the model parameter space:</p>

<div class="highlight highlight-r"><pre>library(<span class="pl-smi">ggplot2</span>)

ggplot(<span class="pl-smi">dat</span>, aes(<span class="pl-v">x</span> <span class="pl-k">=</span> <span class="pl-smi">scout_prob</span>, <span class="pl-v">y</span> <span class="pl-k">=</span> <span class="pl-smi">survival_prob</span>)) <span class="pl-k">+</span>
  geom_point() <span class="pl-k">+</span>
  geom_point(<span class="pl-v">data</span> <span class="pl-k">=</span> subset(<span class="pl-smi">dat</span>, <span class="pl-smi">c_abundance</span>), <span class="pl-v">color</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>red<span class="pl-pds">"</span></span>, <span class="pl-v">size</span> <span class="pl-k">=</span> <span class="pl-c1">7</span>, <span class="pl-v">shape</span> <span class="pl-k">=</span> <span class="pl-c1">2</span>) <span class="pl-k">+</span>
  geom_point(<span class="pl-v">data</span> <span class="pl-k">=</span> subset(<span class="pl-smi">dat</span>, <span class="pl-smi">c_variation</span>), <span class="pl-v">color</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>steelblue<span class="pl-pds">"</span></span>, <span class="pl-v">size</span> <span class="pl-k">=</span> <span class="pl-c1">7</span>, <span class="pl-v">shape</span> <span class="pl-k">=</span> <span class="pl-c1">3</span>) <span class="pl-k">+</span>
  geom_point(<span class="pl-v">data</span> <span class="pl-k">=</span> subset(<span class="pl-smi">dat</span>, <span class="pl-smi">c_vacancy</span>), <span class="pl-v">color</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>darkgreen<span class="pl-pds">"</span></span>, <span class="pl-v">size</span> <span class="pl-k">=</span> <span class="pl-c1">7</span>, <span class="pl-v">shape</span> <span class="pl-k">=</span> <span class="pl-c1">4</span>) <span class="pl-k">+</span>
  theme_minimal()</pre></div>

<p><img src="img/README-p8SplotParameterSpace-1.png" alt=""> </p>

<p>Instead of exploring parameter space with (full) factorial design 
we can use sampling methods. Below is an example with <strong>latin hypercube sampling</strong> 
from <strong>tgp</strong> package:</p>

<div class="highlight highlight-r"><pre><span class="pl-c"># use Latin Hypercube sampling to sample 50 parameter sets</span>
library(<span class="pl-smi">tgp</span>)
<span class="pl-smi">param_sets</span> <span class="pl-k">&lt;-</span> lhs(<span class="pl-v">n</span><span class="pl-k">=</span><span class="pl-c1">50</span>, <span class="pl-v">rect</span><span class="pl-k">=</span><span class="pl-k">matrix</span>(c(<span class="pl-c1">0.0</span>, <span class="pl-c1">0.95</span>, <span class="pl-c1">0.5</span>, <span class="pl-c1">1.0</span>), <span class="pl-c1">2</span>)) 
<span class="pl-smi">param_sets</span> <span class="pl-k">&lt;-</span> setNames(as.data.frame(<span class="pl-smi">param_sets</span>), c(<span class="pl-s"><span class="pl-pds">"</span>scout_prob<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>survival_prob<span class="pl-pds">"</span></span>)) </pre></div>

<p>To change only parameter sets use <code>nl_set_param_values</code>
instead of repeating all experiment definitions with <code>nl_experiment</code>:</p>

<div class="highlight highlight-r"><pre><span class="pl-c"># change parameters of existing experiment</span>
<span class="pl-smi">experiment</span> <span class="pl-k">&lt;-</span> nl_set_param_values( <span class="pl-smi">experiment</span>,
  <span class="pl-v">param_values</span> <span class="pl-k">=</span> <span class="pl-smi">param_sets</span>
)</pre></div>

<p>Run the model with new parameters:</p>

<div class="highlight highlight-r"><pre><span class="pl-smi">result2</span> <span class="pl-k">&lt;-</span> nl_run(<span class="pl-smi">experiment</span>, <span class="pl-v">parallel</span> <span class="pl-k">=</span> <span class="pl-c1">TRUE</span>) 
<span class="pl-c"># get the data (criteria)</span>
<span class="pl-smi">dat2</span> <span class="pl-k">&lt;-</span> nl_get_result(<span class="pl-smi">result2</span>, <span class="pl-v">type</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>criteria<span class="pl-pds">"</span></span>)</pre></div>

<div class="highlight highlight-r"><pre>ggplot(<span class="pl-smi">dat2</span>, aes(<span class="pl-v">x</span> <span class="pl-k">=</span> <span class="pl-smi">scout_prob</span>, <span class="pl-v">y</span> <span class="pl-k">=</span> <span class="pl-smi">survival_prob</span>)) <span class="pl-k">+</span>
  geom_point() <span class="pl-k">+</span>
  geom_point(<span class="pl-v">data</span> <span class="pl-k">=</span> subset(<span class="pl-smi">dat2</span>, <span class="pl-smi">c_abundance</span>), <span class="pl-v">color</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>red<span class="pl-pds">"</span></span>, <span class="pl-v">size</span> <span class="pl-k">=</span> <span class="pl-c1">7</span>, <span class="pl-v">shape</span> <span class="pl-k">=</span> <span class="pl-c1">2</span>) <span class="pl-k">+</span>
  geom_point(<span class="pl-v">data</span> <span class="pl-k">=</span> subset(<span class="pl-smi">dat2</span>, <span class="pl-smi">c_variation</span>), <span class="pl-v">color</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>steelblue<span class="pl-pds">"</span></span>, <span class="pl-v">size</span> <span class="pl-k">=</span> <span class="pl-c1">7</span>, <span class="pl-v">shape</span> <span class="pl-k">=</span> <span class="pl-c1">3</span>) <span class="pl-k">+</span>
  geom_point(<span class="pl-v">data</span> <span class="pl-k">=</span> subset(<span class="pl-smi">dat2</span>, <span class="pl-smi">c_vacancy</span>), <span class="pl-v">color</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>seagreen<span class="pl-pds">"</span></span>, <span class="pl-v">size</span> <span class="pl-k">=</span> <span class="pl-c1">7</span>, <span class="pl-v">shape</span> <span class="pl-k">=</span> <span class="pl-c1">4</span>) <span class="pl-k">+</span>
  theme_minimal()</pre></div>

<p><img src="img/README-p8Aggregate2-1.png" alt=""> </p>

<h2>
<a id="best-fit-criteria-function" class="anchor" href="#best-fit-criteria-function" aria-hidden="true"><span class="octicon octicon-link"></span></a>Best-fit criteria function</h2>

<p>As in Thiele, Kurth &amp; Grimm (2014) define general cost function which
is 0 when criteria are met and &gt; 0 outside acceptable ranges:</p>

<div class="highlight highlight-r"><pre><span class="pl-en">cond_cost_function</span> <span class="pl-k">&lt;-</span> <span class="pl-k">function</span>(<span class="pl-smi">value</span>, <span class="pl-smi">minval</span>, <span class="pl-smi">maxval</span>) {
  <span class="pl-c"># squared relative deviation if value outside accepted range</span>
  ifelse(
    <span class="pl-smi">minval</span> <span class="pl-k">&gt;</span> <span class="pl-smi">value</span>  <span class="pl-k">|</span> <span class="pl-smi">value</span> <span class="pl-k">&gt;</span> <span class="pl-smi">maxval</span>,
    <span class="pl-smi">ret</span> <span class="pl-k">&lt;-</span> ((mean(<span class="pl-smi">minval</span>,<span class="pl-smi">maxval</span>) <span class="pl-k">-</span> <span class="pl-smi">value</span>) <span class="pl-k">/</span> mean(<span class="pl-smi">minval</span>,<span class="pl-smi">maxval</span>))<span class="pl-k">^</span><span class="pl-c1">2</span>,
    <span class="pl-c1">0</span>
  )
}</pre></div>

<p><em>Note: the function can use a vector in <code>value</code> attribute</em></p>

<p>The rest is analogous to the previous example (categorical criteria) except 
when <code>eval_mutate</code> defines different criteria:</p>

<div class="highlight highlight-r"><pre><span class="pl-smi">experiment</span> <span class="pl-k">&lt;-</span> nl_experiment( 
  <span class="pl-v">model_file</span> <span class="pl-k">=</span> 
    system.file(<span class="pl-s"><span class="pl-pds">"</span>netlogo_models/SM2_Hoopoes.nlogo<span class="pl-pds">"</span></span>, <span class="pl-v">package</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>nlexperiment<span class="pl-pds">"</span></span>),

  <span class="pl-v">setup_commands</span> <span class="pl-k">=</span> c(<span class="pl-s"><span class="pl-pds">"</span>setup<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>repeat 24 [go]<span class="pl-pds">"</span></span>), <span class="pl-c"># 2 years of warming-up</span>
  <span class="pl-v">go_command</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>repeat 12 [go]<span class="pl-pds">"</span></span>,                 <span class="pl-c"># iteration is per year</span>
  <span class="pl-v">iterations</span> <span class="pl-k">=</span> <span class="pl-c1">20</span>,                               <span class="pl-c"># run for 20 years</span>
  <span class="pl-v">repetitions</span> <span class="pl-k">=</span> <span class="pl-c1">10</span>,                              <span class="pl-c"># repeat simulation 10 times</span>

  <span class="pl-v">param_values</span> <span class="pl-k">=</span> <span class="pl-k">list</span>(                           <span class="pl-c"># "full factor design"</span>
    <span class="pl-v">scout_prob</span> <span class="pl-k">=</span> seq(<span class="pl-v">from</span> <span class="pl-k">=</span> <span class="pl-c1">0.00</span>, <span class="pl-v">to</span> <span class="pl-k">=</span> <span class="pl-c1">0.50</span>, <span class="pl-v">by</span> <span class="pl-k">=</span> <span class="pl-c1">0.05</span>),
    <span class="pl-v">survival_prob</span> <span class="pl-k">=</span> seq(<span class="pl-v">from</span> <span class="pl-k">=</span> <span class="pl-c1">0.950</span>, <span class="pl-v">to</span> <span class="pl-k">=</span> <span class="pl-c1">1.000</span>, <span class="pl-v">by</span> <span class="pl-k">=</span> <span class="pl-c1">0.005</span>)
  ),
  <span class="pl-v">mapping</span> <span class="pl-k">=</span> c(                                   <span class="pl-c"># map NetLogo variables</span>
    <span class="pl-v">scout_prob</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>scout-prob<span class="pl-pds">"</span></span>, 
    <span class="pl-v">survival_prob</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>survival-prob<span class="pl-pds">"</span></span>
  ),

  <span class="pl-v">step_measures</span> <span class="pl-k">=</span> measures(                      <span class="pl-c"># NetLogo reporters per step</span>
    <span class="pl-v">abund</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>month-11-count<span class="pl-pds">"</span></span>,             
    <span class="pl-v">alpha</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>month-11-alpha<span class="pl-pds">"</span></span>,                 
    <span class="pl-v">patches_count</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>count patches<span class="pl-pds">"</span></span>
  ),

  <span class="pl-v">eval_criteria</span> <span class="pl-k">=</span> criteria(                      <span class="pl-c"># evaluation per each run</span>
    <span class="pl-v">abundance</span> <span class="pl-k">=</span> mean(<span class="pl-smi">step</span><span class="pl-k">$</span><span class="pl-smi">abund</span>),
    <span class="pl-v">variation</span> <span class="pl-k">=</span> sd(<span class="pl-smi">step</span><span class="pl-k">$</span><span class="pl-smi">abund</span>),
    <span class="pl-v">vacancy</span> <span class="pl-k">=</span> mean(<span class="pl-smi">step</span><span class="pl-k">$</span><span class="pl-smi">alpha</span> <span class="pl-k">/</span> <span class="pl-smi">step</span><span class="pl-k">$</span><span class="pl-smi">patches_count</span>)
  ),

  <span class="pl-v">eval_aggregate_fun</span> <span class="pl-k">=</span> <span class="pl-smi">mean</span>,                     <span class="pl-c"># mean value (10 repetitions)</span>

  <span class="pl-v">eval_mutate</span> <span class="pl-k">=</span> criteria(                        <span class="pl-c"># add categorical values</span>
    <span class="pl-v">cost</span> <span class="pl-k">=</span> 
      cond_cost_function(<span class="pl-smi">abundance</span>, <span class="pl-c1">115</span>, <span class="pl-c1">135</span>) <span class="pl-k">+</span>
      cond_cost_function(<span class="pl-smi">variation</span>, <span class="pl-c1">10</span>, <span class="pl-c1">15</span>) <span class="pl-k">+</span>
      cond_cost_function(<span class="pl-smi">vacancy</span>, <span class="pl-c1">0.15</span>, <span class="pl-c1">0.30</span>)
  )  
)</pre></div>

<p>Run experiment:</p>

<div class="highlight highlight-r"><pre><span class="pl-smi">result</span> <span class="pl-k">&lt;-</span> nl_run(<span class="pl-smi">experiment</span>, <span class="pl-v">parallel</span> <span class="pl-k">=</span> <span class="pl-c1">TRUE</span>) 
<span class="pl-c"># get the data (criteria)</span>
<span class="pl-smi">dat</span> <span class="pl-k">&lt;-</span> nl_get_result(<span class="pl-smi">result</span>, <span class="pl-v">type</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>criteria<span class="pl-pds">"</span></span>) </pre></div>

<p>Plot evaluation criteria on the model parameter space:</p>

<div class="highlight highlight-r"><pre>library(<span class="pl-smi">ggplot2</span>)
ggplot(<span class="pl-smi">dat</span> , aes(<span class="pl-v">x</span> <span class="pl-k">=</span> <span class="pl-k">factor</span>(<span class="pl-smi">scout_prob</span>), <span class="pl-v">y</span> <span class="pl-k">=</span> <span class="pl-k">factor</span>(<span class="pl-smi">survival_prob</span>), <span class="pl-v">fill</span> <span class="pl-k">=</span> pmin(<span class="pl-smi">cost</span>, <span class="pl-c1">30</span>))) <span class="pl-k">+</span>
  geom_tile() <span class="pl-k">+</span> theme_minimal() <span class="pl-k">+</span> labs(<span class="pl-v">x</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>scout_prob<span class="pl-pds">"</span></span>, <span class="pl-v">y</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>survival_prob<span class="pl-pds">"</span></span>) <span class="pl-k">+</span>
  coord_fixed()</pre></div>

<p><img src="img/README-p9SplotParameterSpace-1.png" alt=""> </p>

<h2>
<a id="parameter-fitting-and-optimization--l-bfgs-b" class="anchor" href="#parameter-fitting-and-optimization--l-bfgs-b" aria-hidden="true"><span class="octicon octicon-link"></span></a>Parameter fitting and optimization / L-BFGS-B</h2>

<p>Using experiment definition from 
<a href="#best-fit%20criteria%20function">previous chapter: best-fit criteria function</a>
we could search the parameter space to optimize the cost function.</p>

<p>When using optimization methods we can't pre-define parameter sets because they
are selected as optimization runs. In this scenario the <code>nl_eval_run</code> function should be used instead of <code>nl_run</code>. </p>

<p>There are two differences:</p>

<ul>
<li>
<code>nl_run_eval</code> accepts a parameter set and returns a value </li>
<li>It requires NetLogo instance - user have to take care to initialize NetLogo and load the model before optimization begins and 
close NetLogo when it is no longer needed (see functions <code>nl_eval_init</code> and <code>nl_eval_close</code>).</li>
</ul>

<p>Use <code>nl_eval_run</code> <em>parallel</em> option when optimizing stochastic models
with more than a few repetitions needed to evaluate one parameter set. </p>

<p>There are many R packages for solving optimization problems 
(see <a href="https://cran.r-project.org/web/views/Optimization.html">CRAN Task View</a>).
This example use <strong>L-BFGS-B method</strong> with standard <code>stats::optim</code> function.
See also Thiele, Kurth &amp; Grimm (2014) chapter 
<a href="http://jasss.soc.surrey.ac.uk/17/3/11.html#sectionGQNM">2.28 Gradient and quasi-Newton methods</a>.</p>

<div class="highlight highlight-r"><pre><span class="pl-c"># parameter range from experiment</span>
<span class="pl-smi">param_range</span> <span class="pl-k">&lt;-</span> nl_get_param_range(<span class="pl-smi">experiment</span>)   

<span class="pl-c"># initialize evaluation</span>
<span class="pl-smi">cl</span> <span class="pl-k">&lt;-</span> nl_eval_init(<span class="pl-smi">experiment</span>, <span class="pl-v">parallel</span> <span class="pl-k">=</span> <span class="pl-c1">TRUE</span>)
<span class="pl-c">#&gt; [1] "Creating sockets..."</span>

<span class="pl-c"># create callback container to spy what the optim function is doing</span>
<span class="pl-smi">trace</span> <span class="pl-k">&lt;-</span> nl_eval_tracer(<span class="pl-v">verbose</span> <span class="pl-k">=</span> <span class="pl-c1">FALSE</span>)

<span class="pl-c">#call optimisation function with L-BFGS-B method:</span>
<span class="pl-smi">o_result</span> <span class="pl-k">&lt;-</span> optim(
  <span class="pl-v">par</span> <span class="pl-k">=</span> c(<span class="pl-c1">0.5</span>, <span class="pl-c1">1.0</span>),  
  <span class="pl-smi">nl_eval_run</span>, 
    <span class="pl-v">experiment</span> <span class="pl-k">=</span> <span class="pl-smi">experiment</span>, <span class="pl-v">criteria</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>cost<span class="pl-pds">"</span></span>, 
    <span class="pl-v">call_back</span> <span class="pl-k">=</span> <span class="pl-smi">trace</span><span class="pl-k">$</span><span class="pl-smi">add</span>, <span class="pl-v">parallel</span> <span class="pl-k">=</span> <span class="pl-c1">TRUE</span>, <span class="pl-v">cluster</span> <span class="pl-k">=</span> <span class="pl-smi">cl</span>,
  <span class="pl-v">method</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>L-BFGS-B<span class="pl-pds">"</span></span>,
  <span class="pl-v">lower</span> <span class="pl-k">=</span> <span class="pl-smi">param_range</span><span class="pl-k">$</span><span class="pl-smi">lower</span>, <span class="pl-v">upper</span> <span class="pl-k">=</span> <span class="pl-smi">param_range</span><span class="pl-k">$</span><span class="pl-smi">upper</span>, 
  <span class="pl-v">control</span> <span class="pl-k">=</span> <span class="pl-k">list</span>(<span class="pl-v">maxit</span> <span class="pl-k">=</span> <span class="pl-c1">200</span>, <span class="pl-v">trace</span> <span class="pl-k">=</span> <span class="pl-c1">1</span>))
<span class="pl-c">#&gt; final  value 0.023308 </span>
<span class="pl-c">#&gt; converged</span>

nl_eval_close(<span class="pl-v">parallel</span> <span class="pl-k">=</span> <span class="pl-c1">TRUE</span>, <span class="pl-smi">cl</span>)</pre></div>

<div class="highlight highlight-r"><pre><span class="pl-c">#final result:</span>
<span class="pl-smi">o_result</span>
<span class="pl-c">#&gt; $par</span>
<span class="pl-c">#&gt; [1] 0.266740 0.976674</span>
<span class="pl-c">#&gt; </span>
<span class="pl-c">#&gt; $value</span>
<span class="pl-c">#&gt; [1] 0.02330759</span>
<span class="pl-c">#&gt; </span>
<span class="pl-c">#&gt; $counts</span>
<span class="pl-c">#&gt; function gradient </span>
<span class="pl-c">#&gt;       22       22 </span>
<span class="pl-c">#&gt; </span>
<span class="pl-c">#&gt; $convergence</span>
<span class="pl-c">#&gt; [1] 0</span>
<span class="pl-c">#&gt; </span>
<span class="pl-c">#&gt; $message</span>
<span class="pl-c">#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH"</span></pre></div>

<p>The <code>trace$add</code> function colected every iteration of <code>optim</code>. </p>

<div class="highlight highlight-r"><pre><span class="pl-smi">dat</span> <span class="pl-k">&lt;-</span> <span class="pl-smi">trace</span><span class="pl-k">$</span>get()

library(<span class="pl-smi">ggplot2</span>)

ggplot(<span class="pl-smi">dat</span>, aes(<span class="pl-v">x</span><span class="pl-k">=</span><span class="pl-smi">iter_id</span>, <span class="pl-v">y</span> <span class="pl-k">=</span> <span class="pl-smi">result</span>)) <span class="pl-k">+</span>
  geom_step() <span class="pl-k">+</span>
  labs(<span class="pl-v">x</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Iteration<span class="pl-pds">"</span></span>, <span class="pl-v">y</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Evaluation result<span class="pl-pds">"</span></span>)</pre></div>

<p><img src="img/README-p10plot-1.png" alt=""> </p>

<p>Optim iterations on parameter space:</p>

<div class="highlight highlight-r"><pre>

ggplot(<span class="pl-smi">dat</span>, aes(<span class="pl-v">x</span> <span class="pl-k">=</span> <span class="pl-smi">scout_prob</span>, <span class="pl-v">y</span> <span class="pl-k">=</span> <span class="pl-smi">survival_prob</span>, <span class="pl-v">color</span> <span class="pl-k">=</span> pmin(<span class="pl-c1">20</span>,<span class="pl-smi">result</span>))) <span class="pl-k">+</span>
  <span class="pl-c">#  geom_line(color = "gray", size = 1, ) +</span>
  geom_point(<span class="pl-v">size</span> <span class="pl-k">=</span> <span class="pl-c1">3</span>) <span class="pl-k">+</span>
  geom_point(
    <span class="pl-v">color</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>red<span class="pl-pds">"</span></span>, 
    <span class="pl-v">data</span> <span class="pl-k">=</span> <span class="pl-k">data.frame</span>(<span class="pl-v">scout_prob</span> <span class="pl-k">=</span> <span class="pl-smi">o_result</span><span class="pl-k">$</span><span class="pl-smi">par</span>[<span class="pl-c1">1</span>], <span class="pl-v">survival_prob</span> <span class="pl-k">=</span> <span class="pl-smi">o_result</span><span class="pl-k">$</span><span class="pl-smi">par</span>[<span class="pl-c1">2</span>]),
    <span class="pl-v">size</span> <span class="pl-k">=</span> <span class="pl-c1">20</span>, <span class="pl-v">shape</span> <span class="pl-k">=</span> <span class="pl-c1">4</span>) <span class="pl-k">+</span>
  theme_minimal()</pre></div>

<p><img src="img/README-unnamed-chunk-24-1.png" alt=""> </p>

<h2>
<a id="references" class="anchor" href="#references" aria-hidden="true"><span class="octicon octicon-link"></span></a>References</h2>

<ul>
<li><p>Wilensky, U. (1999). NetLogo. <a href="http://ccl.northwestern.edu/netlogo/">http://ccl.northwestern.edu/netlogo/</a>. Center for Connected Learning and Computer-Based Modeling, Northwestern University, Evanston, IL.</p></li>
<li><p>Thiele, J. (2014) R Marries NetLogo: Introduction to the RNetLogo Package. Journal of Statistical Software 58(2) 1-41. <a href="http://www.jstatsoft.org/v58/i02/">http://www.jstatsoft.org/v58/i02/</a></p></li>
<li><p>Railsback, S. F., &amp; Grimm, V. (2011). Agent-Based and Individual-Based Modeling: A Practical Introduction. Princeton University Press.</p></li>
<li><p>Thiele, J. C., Kurth, W., &amp; Grimm, V. (2014). Facilitating Parameter Estimation and Sensitivity Analysis of Agent-Based Models: A Cookbook Using NetLogo and R. Journal of Artificial Societies and Social Simulation, 17(3), 11. <a href="http://jasss.soc.surrey.ac.uk/17/3/11.html">http://jasss.soc.surrey.ac.uk/17/3/11.html</a></p></li>
<li><p>Wilensky, U. (1997). NetLogo Fire model. <a href="http://ccl.northwestern.edu/netlogo/models/Fire">http://ccl.northwestern.edu/netlogo/models/Fire</a>. Center for Connected Learning and Computer-Based Modeling, Northwestern University, Evanston, IL.</p></li>
<li><p>Wilensky, U. (1997). NetLogo Ants model. <a href="http://ccl.northwestern.edu/netlogo/models/Ants">http://ccl.northwestern.edu/netlogo/models/Ants</a>. Center for Connected Learning and Computer-Based Modeling, Northwestern University, Evanston, IL.</p></li>
<li><p>Wilensky, U. (2003). NetLogo Fur model. <a href="http://ccl.northwestern.edu/netlogo/models/Fur">http://ccl.northwestern.edu/netlogo/models/Fur</a>. Center for Connected Learning and Computer-Based Modeling, Northwestern University, Evanston, IL.</p></li>
<li><p>Wilensky, U. (2005). NetLogo Preferential Attachment model. <a href="http://ccl.northwestern.edu/netlogo/models/PreferentialAttachment">http://ccl.northwestern.edu/netlogo/models/PreferentialAttachment</a>. Center for Connected Learning and Computer-Based Modeling, Northwestern University, Evanston, IL.</p></li>
<li><p>Wilensky, U., &amp; Shargel, B. (2002). BehaviorSpace. Center for Connected Learning and Computer Based Modeling, Northwestern University, Evanston, IL. <a href="http://ccl.northwestern.edu/netlogo/behaviorspace.html">http://ccl.northwestern.edu/netlogo/behaviorspace.html</a></p></li>
</ul>

<h2>
<a id="resources" class="anchor" href="#resources" aria-hidden="true"><span class="octicon octicon-link"></span></a>Resources</h2>

<ul>
<li><p>nlexperiment requires RNetLogo to connect to NetLogo
<a href="https://cran.r-project.org/web/packages/RNetLogo/index.html">https://cran.r-project.org/web/packages/RNetLogo/index.html</a></p></li>
<li><p>The parallel implementation of <code>nl_run</code> function is based on the RNetLogo vignette
<a href="https://cran.r-project.org/web/packages/RNetLogo/vignettes/parallelProcessing.pdf">https://cran.r-project.org/web/packages/RNetLogo/vignettes/parallelProcessing.pdf</a></p></li>
<li><p>Basic ideas and principles of NetLogo experiment definition is taken from
the NetLogo's Behavior Space tool
<a href="http://ccl.northwestern.edu/netlogo/docs/behaviorspace.html">http://ccl.northwestern.edu/netlogo/docs/behaviorspace.html</a></p></li>
<li><p>This tutorial follows examples and methods from Thiele, Kurth &amp; Grimm (2014)
article and its Supplementary Material
<a href="http://sourceforge.net/projects/calibrationsensitivityanalysis/">http://sourceforge.net/projects/calibrationsensitivityanalysis/</a></p></li>
<li><p>This document was created with knitr package
<a href="https://cran.r-project.org/web/packages/knitr/index.html">https://cran.r-project.org/web/packages/knitr/index.html</a></p></li>
<li><p>Graphics were created with ggplot2 package
<a href="https://cran.r-project.org/web/packages/ggplot2/index.html">https://cran.r-project.org/web/packages/ggplot2/index.html</a></p></li>
</ul>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">nlexperiment maintained by <a href="https://github.com/bergant">bergant</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
